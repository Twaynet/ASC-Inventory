Navigation and Routing Entrypoints Snapshot
Generated: 2026-02-12
Source: apps/web/src/ (Next.js App Router)

================================================================================
1. NAVIGATION COMPONENTS
================================================================================

Component: Header
File: apps/web/src/app/components/Header.tsx
Renders on: All authenticated pages (each page imports Header directly)
Links produced:
  /dashboard          | "Home" button icon         | Condition: shown when pathname != /dashboard
  /phi/patients       | "Patient Search" button    | Condition: hasCapability('PHI_PATIENT_SEARCH')
  /help               | "?" help button            | Condition: always visible when authenticated
  (dynamic deepLink)  | "View" in AttentionDrawer  | Condition: attention items exist (server-driven deepLink)
Also renders: AdminNav (role-gated), AttentionDrawer, theme toggle, persona selector, sign out

Component: AdminNav
File: apps/web/src/app/components/AdminNav.tsx
Renders on: Header (dropdown menu)
Condition: only renders if userRoles includes 'ADMIN'
Links produced:
  /admin/cases                | "Cases"
  /admin/users                | "Users"
  /admin/locations            | "Locations"
  /admin/catalog              | "Catalog"
  /admin/inventory            | "Inventory"
  /admin/inventory/risk-queue | "Risk Queue"
  /admin/vendors              | "Vendors"
  /admin/loaner-sets          | "Loaner Sets"
  /preference-cards           | "Surgeon Preference Cards"
  /admin/reports              | "Reports"
  /admin/phi-audit            | "PHI Audit"
  /admin/general-settings     | "General Settings"
  /admin/pending-reviews      | "Pending Reviews"
  /admin/surgery-requests     | "Surgery Requests"
  /admin/financial-readiness  | "Financial Readiness"

Component: AdminSettingsSubnav
File: apps/web/src/components/AdminSettingsSubnav.tsx
Renders on: General Settings pages (tab-style subnav)
Links produced:
  /admin/general-settings                | "General Settings"
  /admin/general-settings/case-dashboard | "Case Dashboard"
  /admin/general-settings/operating-rooms| "Operating Rooms"
  /admin/general-settings/surgeons       | "Surgeons"

Component: CalendarNav
File: apps/web/src/app/(app)/calendar/components/CalendarNav.tsx
Renders on: Calendar page
Links produced: None (prev/next/today/view-mode are in-page state changes, not route changes)

Component: Breadcrumbs
File: apps/web/src/components/Breadcrumbs.tsx
Renders on: Various admin subpages
Links produced (by page):
  Operating Rooms page:  /admin/general-settings -> "General Settings"
  Surgeons page:         /admin/general-settings -> "General Settings"
  Case Dashboard page:   /admin/general-settings -> "General Settings"
  Catalog Sets page:     /admin/catalog -> "Catalog"
  Catalog Groups page:   /admin/catalog -> "Catalog"
  Group Detail page:     /admin/catalog -> "Catalog", /admin/catalog/groups -> "Groups"
  Inventory Check-In:    /admin (DEAD LINK - no page exists), /admin/inventory -> "Inventory", /admin/inventory/check-in -> "Check-In"

Component: Catalog Subnav (inline in pages, not separate component)
File: apps/web/src/app/(app)/admin/catalog/page.tsx (and groups/page.tsx, sets/page.tsx)
Links produced:
  /admin/catalog        | "Items"
  /admin/catalog/groups | "Groups"
  /admin/catalog/sets   | "Set Definitions"

Component: Footer
File: apps/web/src/app/components/Footer.tsx
Renders on: All pages (root layout)
Links produced:
  /help | "Help"

Component: AttentionDrawer
File: apps/web/src/app/components/AttentionDrawer.tsx
Renders on: Header (popover)
Links produced (server-driven via API /attention endpoint):
  /admin/loaner-sets?filter=overdue      | type: LOANER_OVERDUE
  /admin/loaner-sets?filter=open         | type: LOANER_DUE_SOON
  /admin/inventory?expiry=EXPIRED        | type: ITEM_EXPIRED
  /admin/inventory?expiry=EXPIRING_SOON  | type: ITEM_EXPIRING_SOON

================================================================================
2. DASHBOARD FEATURE CARDS (access-control-driven navigation)
================================================================================

Source: apps/web/src/lib/access-control.ts FEATURES array
Renders on: /dashboard page via FeatureSection/FeatureCard components

GROUP: core (all authenticated users unless requiredRoles specified)
  /calendar             | "Calendar"               | Condition: authenticated (no role/cap required)
  /cases                | "Case Requests"           | Condition: authenticated (no role/cap required)
  /preference-cards     | "Surgeon Preference Cards"| Condition: authenticated (no role/cap required)
  /pending-reviews      | "My Pending Reviews"      | Condition: authenticated (no role/cap required)
  /surgeon/my-checklists| "My Checklists"           | Condition: requiredRoles=['SURGEON']
  /unassigned-cases     | "Unassigned Cases"        | Condition: requiredRoles=['ADMIN','SCHEDULER']

GROUP: case-workflows (contextual, no direct path)
  (null)                | "Case Dashboard"          | Condition: requiredCapabilities=['CASE_VIEW'], contextual
  (null)                | "Readiness Verification"  | Condition: requiredCapabilities=['VERIFY_SCAN'], contextual
  (null)                | "Debrief"                 | Condition: requiredCapabilities=['OR_DEBRIEF'], contextual
  (null)                | "OR Timeout"              | Condition: requiredCapabilities=['OR_TIMEOUT'], contextual

GROUP: admin
  /admin/cases             | "Cases"              | Condition: requiredRoles=['ADMIN','SCHEDULER']
  /admin/users             | "Users"              | Condition: requiredRoles=['ADMIN'], requiredCapabilities=['USER_MANAGE']
  /admin/locations         | "Locations"          | Condition: requiredRoles=['ADMIN'], requiredCapabilities=['LOCATION_MANAGE']
  /admin/catalog           | "Catalog"            | Condition: requiredRoles=['ADMIN'], requiredCapabilities=['CATALOG_MANAGE']
  /admin/inventory         | "Inventory"          | Condition: requiredRoles=['ADMIN'], requiredCapabilities=['INVENTORY_MANAGE']
  /admin/inventory/check-in| "Inventory Check-In" | Condition: requiredRoles=['ADMIN'], requiredCapabilities=['INVENTORY_CHECKIN']
  /admin/reports           | "Reports"            | Condition: requiredRoles=['ADMIN'], requiredCapabilities=['REPORTS_VIEW']
  /admin/phi-audit         | "PHI Audit"          | Condition: requiredRoles=['ADMIN'], requiredCapabilities=['PHI_AUDIT_ACCESS']
  /admin/general-settings  | "General Settings"   | Condition: requiredRoles=['ADMIN'], requiredCapabilities=['SETTINGS_MANAGE']
  /admin/pending-reviews   | "All Pending Reviews"| Condition: requiredRoles=['ADMIN']

================================================================================
3. REDIRECT RULES AND DEFAULT LANDINGS
================================================================================

Route: / (root)
File: apps/web/src/app/page.tsx
Behavior: If authenticated -> redirect to /dashboard. If not authenticated -> redirect to /login.

Route: /login
File: apps/web/src/app/login/page.tsx
Behavior: If already authenticated (on mount) -> redirect to /dashboard. On successful login -> redirect to /dashboard.

Route: /case-cards (legacy)
File: apps/web/src/app/(app)/case-cards/page.tsx
Behavior: Unconditional redirect to /preference-cards (router.replace). Legacy backward-compat route.

Guard: AuthGuard (layout-level)
File: apps/web/src/app/(app)/layout.tsx -> apps/web/src/app/components/AuthGuard.tsx
Behavior: All routes under (app)/ group. If not authenticated -> redirect to /login.

Guard: PlatformLayout (layout-level)
File: apps/web/src/app/(app)/platform/layout.tsx
Behavior: All routes under (app)/platform/. If not hasRole('PLATFORM_ADMIN') -> renders "Access Denied" (no redirect).

NOTE: There is NO Next.js middleware.ts file in this project. All auth/redirect logic is client-side.

================================================================================
4. ALL DEFINED ROUTES (page.tsx files)
================================================================================

UNAUTHENTICATED ROUTES (outside (app) group):
  /                    | Root redirect page
  /login               | Login page

AUTHENTICATED ROUTES (inside (app) group, AuthGuard protected):

  Core / General:
  /dashboard                                  | System Dashboard (home)
  /calendar                                   | Calendar view (supports ?view=, ?date=, ?openCase= params)
  /cases                                      | Case Requests
  /preference-cards                           | Surgeon Preference Cards
  /pending-reviews                            | My Pending Reviews
  /unassigned-cases                           | Unassigned Cases
  /help                                       | Help & FAQ
  /case-cards                                 | Legacy redirect -> /preference-cards
  /surgeon/my-checklists                      | Surgeon's completed checklists

  Case Workflow (dynamic):
  /case/[caseId]                              | Case Dashboard (full page)
  /case/[caseId]/verify                       | Readiness Verification (supports ?returnTo=, ?openModal= params)
  /or/timeout/[caseId]                        | OR Timeout checklist
  /or/debrief/[caseId]                        | Debrief checklist

  PHI:
  /phi/patients                               | Patient Search

  Admin:
  /admin/cases                                | Admin Cases management
  /admin/users                                | User management
  /admin/locations                            | Location management
  /admin/catalog                              | Catalog Items
  /admin/catalog/groups                       | Catalog Groups
  /admin/catalog/groups/[groupId]             | Catalog Group Detail
  /admin/catalog/sets                         | Catalog Set Definitions
  /admin/inventory                            | Inventory management (supports ?expiry= param)
  /admin/inventory/check-in                   | Inventory Check-In (supports ?caseId= param)
  /admin/inventory/risk-queue                 | Risk Queue
  /admin/vendors                              | Vendor management
  /admin/loaner-sets                          | Loaner Sets (supports ?filter= param)
  /admin/reports                              | Reports
  /admin/phi-audit                            | PHI Audit Log
  /admin/general-settings                     | General Settings hub
  /admin/general-settings/case-dashboard      | Case Dashboard settings
  /admin/general-settings/operating-rooms     | Operating Rooms settings
  /admin/general-settings/surgeons            | Surgeon settings
  /admin/pending-reviews                      | All Pending Reviews (admin-wide)
  /admin/surgery-requests                     | Surgery Requests list
  /admin/surgery-requests/[id]                | Surgery Request detail
  /admin/financial-readiness                  | Financial Readiness list
  /admin/financial-readiness/[requestId]      | Financial Readiness detail

  Platform:
  /platform                                   | Platform Administration (Config Keys, Facility Overrides, Audit Log, Auth Log)

================================================================================
5. PAGE-LEVEL ACCESS GUARDS (client-side)
================================================================================

Route                                       | Guard Type         | Condition
--------------------------------------------|--------------------|--------------------------------------------
All (app)/* routes                          | AuthGuard (layout) | Must be authenticated, else redirect /login
/platform/*                                 | PlatformLayout     | Must have role PLATFORM_ADMIN, else "Access Denied"
/admin/cases                                | hasRole check      | ADMIN or SCHEDULER
/admin/users                                | hasRole check      | ADMIN
/admin/locations                            | usePageData        | requiredRoles=['ADMIN']
/admin/catalog                              | usePageData        | requiredRoles=['ADMIN']
/admin/catalog/groups                       | usePageData        | requiredRoles=['ADMIN']
/admin/catalog/groups/[groupId]             | usePageData        | requiredRoles=['ADMIN']
/admin/catalog/sets                         | usePageData        | requiredRoles=['ADMIN']
/admin/inventory                            | hasRole check      | ADMIN
/admin/inventory/check-in                   | hasCapability      | INVENTORY_CHECKIN or INVENTORY_MANAGE
/admin/inventory/risk-queue                 | hasRole check      | ADMIN
/admin/vendors                              | isAdmin check      | ADMIN (via user.roles.includes)
/admin/loaner-sets                          | isAdmin check      | ADMIN (via user.roles.includes)
/admin/phi-audit                            | roles check        | ADMIN (via user.roles.includes)
/admin/general-settings                     | isAdmin check      | ADMIN (via user.roles.includes)
/admin/general-settings/case-dashboard      | isAdmin check      | ADMIN (via user.roles.includes)
/admin/general-settings/operating-rooms     | isAdmin check      | ADMIN (via user.roles.includes)
/admin/general-settings/surgeons            | isAdmin check      | ADMIN (via user.roles.includes)
/admin/pending-reviews                      | hasRole check      | ADMIN
/admin/surgery-requests                     | hasRole check      | ADMIN or SCHEDULER
/admin/surgery-requests/[id]                | hasRole check      | ADMIN or SCHEDULER
/admin/financial-readiness                  | hasRole check      | ADMIN
/admin/financial-readiness/[requestId]      | hasRole check      | ADMIN
/surgeon/my-checklists                      | hasRole check      | SURGEON
/phi/patients                               | hasCapability      | PHI_PATIENT_SEARCH (renders "Access Denied" if missing)

NO CLIENT-SIDE GUARD (rely on API-level auth only):
/admin/reports                              | NONE               | No client role check found
/calendar                                   | NONE               | Authenticated only (AuthGuard)
/cases                                      | NONE               | Authenticated only (AuthGuard)
/preference-cards                           | NONE               | Authenticated only (AuthGuard)
/pending-reviews                            | NONE               | Authenticated only (AuthGuard)
/unassigned-cases                           | NONE               | Authenticated only (AuthGuard)
/help                                       | NONE               | Authenticated only (AuthGuard)
/case/[caseId]                              | NONE               | Authenticated only (AuthGuard)
/case/[caseId]/verify                       | NONE               | Authenticated only (AuthGuard, uses roles for UI)
/or/timeout/[caseId]                        | NONE               | Authenticated only (AuthGuard)
/or/debrief/[caseId]                        | NONE               | Authenticated only (AuthGuard)

================================================================================
6. DEEP-LINK ENTRYPOINTS (routes accessed via programmatic navigation, not primary nav)
================================================================================

Route                                       | Linked From
--------------------------------------------|----------------------------------------------------
/case/[caseId]                              | Calendar DayView, ScheduleCard click, check-in "View Case" button, verify page "Back to Case", debrief/timeout "Back to Case"
/case/[caseId]/verify                       | CaseDashboardContent "Verify Readiness" button
/or/timeout/[caseId]                        | CaseDashboardContent "Start Timeout" button, Calendar DayView action button, admin pending-reviews "Complete" button
/or/debrief/[caseId]                        | CaseDashboardContent "Start Debrief" button, Calendar DayView action button, admin pending-reviews "Complete" button, user pending-reviews "Complete" button
/admin/inventory/check-in?caseId=X          | CaseDashboardContent "Check In Inventory" button
/calendar?view=day&date=X                   | Unassigned cases "View in Calendar" button
/calendar?openCase=X                        | PHI patient search case click, debrief/timeout success "View in Calendar" button, verify page returnTo
/admin/general-settings/operating-rooms     | RoomBasedDayView "Configure Operating Rooms" link (when no rooms)
/pending-reviews                            | Calendar DayView "Pending Reviews" link
/admin/surgery-requests/[id]                | Surgery Requests list row click
/admin/financial-readiness/[requestId]      | Financial Readiness list row click
/admin/catalog/groups/[groupId]             | Catalog Groups list (implicit from listing page)
/admin/loaner-sets?filter=overdue           | AttentionDrawer (LOANER_OVERDUE items)
/admin/loaner-sets?filter=open              | AttentionDrawer (LOANER_DUE_SOON items)
/admin/inventory?expiry=EXPIRED             | AttentionDrawer (ITEM_EXPIRED items)
/admin/inventory?expiry=EXPIRING_SOON       | AttentionDrawer (ITEM_EXPIRING_SOON items)
/platform                                   | Dashboard "Open Platform Administration" button (PLATFORM_ADMIN only)

================================================================================
7. ORPHANED OR NOTABLE ROUTE ISSUES
================================================================================

ROUTES IN ADMINNAV BUT NOT IN DASHBOARD FEATURES ARRAY:
  /admin/surgery-requests      | In AdminNav, NOT in access-control.ts FEATURES array
  /admin/financial-readiness   | In AdminNav, NOT in access-control.ts FEATURES array
  /admin/inventory/risk-queue  | In AdminNav, NOT in access-control.ts FEATURES array
  /admin/vendors               | In AdminNav, NOT in access-control.ts FEATURES array
  /admin/loaner-sets           | In AdminNav, NOT in access-control.ts FEATURES array

ROUTES NOT LINKED FROM ANY NAVIGATION COMPONENT:
  /phi/patients                | Only linked from Header "Patient Search" button (capability-gated), not in AdminNav or Dashboard features
  /surgeon/my-checklists       | Only linked from Dashboard feature card (role-gated to SURGEON)
  /case-cards                  | Legacy redirect, no active links point here (backward-compat only)

DEAD BREADCRUMB LINK:
  /admin                       | Referenced in check-in page breadcrumb ({ label: 'Admin', href: '/admin' }), but no /admin/page.tsx exists. This will render the Next.js 404 page.

ROUTES WITH NO CLIENT-SIDE ROLE GUARD (notable):
  /admin/reports               | AdminNav lists it, dashboard FEATURES requires ADMIN + REPORTS_VIEW, but the page itself has no client-side guard. API-level protection only.

QUERY PARAMETER ENTRYPOINTS (not separate routes but affect page behavior):
  /calendar?view=day|week|month&date=YYYY-MM-DD  | Calendar view mode and date
  /calendar?openCase=[caseId]                     | Auto-opens case dashboard modal
  /case/[caseId]/verify?returnTo=X&openModal=true | Return path after verification
  /admin/inventory?expiry=EXPIRED|EXPIRING_SOON   | Pre-filter inventory by expiry status
  /admin/inventory/check-in?caseId=X              | Pre-load case context for check-in
  /admin/loaner-sets?filter=all|open|overdue|returned | Pre-filter loaner sets

================================================================================
END OF SNAPSHOT
================================================================================
